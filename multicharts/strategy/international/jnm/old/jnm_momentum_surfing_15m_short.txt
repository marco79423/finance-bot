// JNM 15 min
// Backtest time: 2014/01/01 - 2024/01/01 Exchange

inputs: Enabled(1), OrderSize(1);

if Enabled = 0 then
	#Return;


vars: Len(40), NN(4);
vars: BigK(0);
BigK = StandardDev(Close, Len, 1) * NN ;
if BigK < 10 then begin
	BigK = 9999;
end;

if Close < AvgPrice[1] - BigK then begin
	SellShort ("SE") OrderSize contracts next bar market;
end;

vars: Base(0.011);
vars: Profit_Percent(2 * Base), StopLoss_Percent(1 * Base);

if MarketPosition <> 0 then begin
	if OpenPositionProfit > 0 and Close < EntryPrice - EntryPrice * Profit_Percent then begin
		BuyToCover ("SX_PT") all contracts next bar market;
	end;

	if Close > EntryPrice + StopLoss_Percent * EntryPrice then begin
		BuyToCover ("SX_SL") all contracts next bar market;
	end;
end;

